{
    "paths": {
        "/incalls": {
            "get": {
                "operationId": "list_incalls",
                "summary": "List incoming calls",
                "description": "**Required ACL:** `confd.incalls.read`",
                "tags": [
                    "incalls"
                ],
                "parameters": [
                    {
                        "$ref": "#/parameters/order"
                    },
                    {
                        "$ref": "#/parameters/direction"
                    },
                    {
                        "$ref": "#/parameters/limit"
                    },
                    {
                        "$ref": "#/parameters/offset"
                    },
                    {
                        "$ref": "#/parameters/search"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Incoming calls list",
                        "schema": {
                            "$ref": "#/definitions/IncallItems"
                        }
                    }
                }
            },
            "post": {
                "operationId": "create_incall",
                "summary": "Create incoming call",
                "description": "**Required ACL:** `confd.incalls.create`",
                "tags": [
                    "incalls"
                ],
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "description": "Incoming call to create",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/Incall"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Incoming call created",
                        "schema": {
                            "$ref": "#/definitions/Incall"
                        }
                    },
                    "400": {
                        "$ref": "#/responses/CreateError"
                    }
                }
            }
        },
        "/incalls/{incall_id}": {
            "get": {
                "operationId": "get_incall",
                "summary": "Get incoming call",
                "description": "**Required ACL:** `confd.incalls.{incall_id}.read`",
                "tags": [
                    "incalls"
                ],
                "parameters": [
                    {
                        "$ref": "#/parameters/incallid"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Incoming call",
                        "schema": {
                            "$ref": "#/definitions/Incall"
                        }
                    },
                    "404": {
                        "$ref": "#/responses/NotFoundError"
                    }
                }
            },
            "put": {
                "operationId": "update_incall",
                "summary": "Update incoming call",
                "description": "**Required ACL:** `confd.incalls.{incall_id}.update`",
                "tags": [
                    "incalls"
                ],
                "parameters": [
                    {
                        "$ref": "#/parameters/incallid"
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/Incall"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "$ref": "#/responses/ResourceUpdated"
                    },
                    "400": {
                        "$ref": "#/responses/UpdateError"
                    },
                    "404": {
                        "$ref": "#/responses/NotFoundError"
                    }
                }
            },
            "delete": {
                "operationId": "delete_incall",
                "summary": "Delete incoming call",
                "description": "**Required ACL:** `confd.incalls.{incall_id}.delete`",
                "tags": [
                    "incalls"
                ],
                "parameters": [
                    {
                        "$ref": "#/parameters/incallid"
                    }
                ],
                "responses": {
                    "204": {
                        "$ref": "#/responses/ResourceDeleted"
                    },
                    "400": {
                        "$ref": "#/responses/DeleteError"
                    },
                    "404": {
                        "$ref": "#/responses/NotFoundError"
                    }
                }
            }
        }
    },
    "parameters": {
        "incallid": {
            "required": true,
            "type": "integer",
            "name": "incall_id",
            "in": "path",
            "description": "Incoming call's ID"
        }
    },
    "definitions": {
        "Incall": {
            "title": "Incall",
            "properties": {
                "id": {
                    "type": "integer",
                    "readOnly": true,
                    "description": "The id of the incoming call"
                },
                "preprocess_subroutine": {
                    "type": "string",
                    "description": "Name of the subroutine to execute in asterisk before receiving a call"
                },
                "description": {
                    "type": "string",
                    "description": "Additional information about the incoming call"
                },
                "caller_id_mode": {
                    "type": "string",
                    "enum": [
                        "prepend",
                        "overwrite",
                        "append"
                    ],
                    "description": "How the caller_id_name will be treated"
                },
                "caller_id_name": {
                    "type": "string",
                    "description": "Name to display when calling"
                },
                "destination": {
                    "description": "The destination where the incoming call will be redirected",
                    "$ref": "#/definitions/IncallDestinationType"
                }
            },
            "required": [
                "destination"
            ],
            "example": {
                "id": 1,
                "preprocess_subroutine": "subroutine",
                "description": "My incall",
                "caller_id_mode": "prepend",
                "caller_id_name": "incall_",
                "destination": {
                    "type": "user",
                    "user_id": 2,
                    "ring_time": 10.5
                }
            }
        },
        "IncallDestinationType": {
            "title": "IncallDestinationType",
            "properties": {
                "application": {
                    "$ref": "#/definitions/IncallDestinationApplicationApplication"
                },
                "conference": {
                    "$ref": "#/definitions/IncallDestinationConference"
                },
                "custom": {
                    "$ref": "#/definitions/IncallDestinationCustom"
                },
                "extension": {
                    "$ref": "#/definitions/IncallDestinationExtension"
                },
                "group": {
                    "$ref": "#/definitions/IncallDestinationGroup"
                },
                "hangup": {
                    "$ref": "#/definitions/IncallDestinationHangupCause"
                },
                "none": {
                    "$ref": "#/definitions/IncallDestinationNone"
                },
                "outcall": {
                    "$ref": "#/definitions/IncallDestinationOutcall"
                },
                "sound": {
                    "$ref": "#/definitions/IncallDestinationSound"
                },
                "user": {
                    "$ref": "#/definitions/IncallDestinationUser"
                },
                "voicemail": {
                    "$ref": "#/definitions/IncallDestinationVoicemail"
                }
            }
        },
        "IncallDestinationApplicationApplication": {
            "title": "IncallDestinationApplicationApplication",
            "properties": {
                "callback_disa": {
                    "$ref": "#/definitions/IncallDestinationApplicationCallbackDISA"
                },
                "directory": {
                    "$ref": "#/definitions/IncallDestinationApplicationDirectory"
                },
                "disa": {
                    "$ref": "#/definitions/IncallDestinationApplicationDISA"
                },
                "fax_to_mail": {
                    "$ref": "#/definitions/IncallDestinationApplicationFaxToMail"
                },
                "voicemail": {
                    "$ref": "#/definitions/IncallDestinationApplicationVoicemail"
                }
            }
        },
        "IncallDestinationApplication": {
            "title": "IncallDestinationApplication",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'application'"
                }
            },
            "required": [
                "type"
            ]
        },
        "IncallDestinationApplicationCallbackDISA": {
            "title": "IncallDestinationApplicationCallbackDISA",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationApplication"
                },
                {
                    "properties": {
                        "application": {
                            "type": "string",
                            "description": "MUST be 'callback_disa'"
                        },
                        "context": {
                            "type": "integer",
                            "description": "The context of the application"
                        },
                        "pin": {
                            "type": "string",
                            "description": "the pin of the application"
                        }
                    }
                }
            ],
            "required": [
                "application",
                "context"
            ]
        },
        "IncallDestinationApplicationDirectory": {
            "title": "IncallDestinationApplicationDirectory",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationApplication"
                },
                {
                    "properties": {
                        "application": {
                            "type": "string",
                            "description": "MUST be 'directory'"
                        },
                        "context": {
                            "type": "integer",
                            "description": "The context of the application"
                        }
                    }
                }
            ],
            "required": [
                "application",
                "context"
            ]
        },
        "IncallDestinationApplicationDISA": {
            "title": "IncallDestinationApplicationDISA",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationApplication"
                },
                {
                    "properties": {
                        "application": {
                            "type": "string",
                            "description": "MUST be 'disa'"
                        },
                        "context": {
                            "type": "integer",
                            "description": "The context of the application"
                        },
                        "pin": {
                            "type": "string",
                            "description": "the pin of the application"
                        }
                    }
                }
            ],
            "required": [
                "application",
                "context"
            ]
        },
        "IncallDestinationApplicationFaxToMail": {
            "title": "IncallDestinationApplicationFaxToMail",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationApplication"
                },
                {
                    "properties": {
                        "application": {
                            "type": "string",
                            "description": "MUST be 'fax_to_mail'"
                        },
                        "email": {
                            "type": "string",
                            "description": "The email of the application"
                        }
                    }
                }
            ],
            "required": [
                "application",
                "email"
            ]
        },
        "IncallDestinationApplicationVoicemail": {
            "title": "IncallDestinationApplicationVoicemail",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationApplication"
                },
                {
                    "properties": {
                        "application": {
                            "type": "string",
                            "description": "MUST be 'voicemail'"
                        },
                        "context": {
                            "type": "integer",
                            "description": "The context of the application"
                        }
                    }
                }
            ],
            "required": [
                "application",
                "context"
            ]
        },
        "IncallDestinationConference": {
            "title": "IncallDestinationConference",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'conference'"
                },
                "conference_id": {
                    "type": "integer",
                    "description": "The id of the conference"
                }
            },
            "required": [
                "type",
                "conference_id"
            ]
        },
        "IncallDestinationCustom": {
            "title": "IncallDestinationCustom",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'custom'"
                },
                "command": {
                    "type": "string",
                    "description": "The command to execute"
                }
            },
            "required": [
                "type",
                "command"
            ]
        },
        "IncallDestinationExtension": {
            "title": "IncallDestinationExtension",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'extension'"
                },
                "exten": {
                    "type": "string"
                },
                "context": {
                    "type": "string",
                    "description": "Context of the extension"
                }
            },
            "required": [
                "type",
                "exten",
                "context"
            ]
        },
        "IncallDestinationGroup": {
            "title": "IncallDestinationGroup",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'group'"
                },
                "group_id": {
                    "type": "integer",
                    "description": "The id of the group"
                },
                "ring_time": {
                    "type": "number",
                    "format": "float"
                }
            },
            "required": [
                "type",
                "group_id"
            ]
        },
        "IncallDestinationHangupCause": {
            "title": "IncallDestinationHangupCause",
            "properties": {
                "busy": {
                    "$ref": "#/definitions/IncallDestinationHangupBusy"
                },
                "congestion": {
                    "$ref": "#/definitions/IncallDestinationHangupCongestion"
                },
                "normal": {
                    "$ref": "#/definitions/IncallDestinationHangupNormal"
                }
            }
        },
        "IncallDestinationHangup": {
            "title": "IncallDestinationHangup",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'hangup'"
                }
            },
            "required": [
                "type"
            ]
        },
        "IncallDestinationHangupBusy": {
            "title": "IncallDestinationHangupBusy",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationHangup"
                },
                {
                    "properties": {
                        "cause": {
                            "type": "string",
                            "description": "MUST be 'busy'"
                        },
                        "timeout": {
                            "type": "integer",
                            "description": "The timeout of the hangup"
                        }
                    }
                }
            ],
            "required": [
                "cause"
            ]
        },
        "IncallDestinationHangupCongestion": {
            "title": "IncallDestinationHangupCongestion",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationHangup"
                },
                {
                    "properties": {
                        "cause": {
                            "type": "string",
                            "description": "MUST be 'congestion'"
                        },
                        "timeout": {
                            "type": "integer",
                            "description": "The timeout of the hangup"
                        }
                    }
                }
            ],
            "required": [
                "cause"
            ]
        },
        "IncallDestinationHangupNormal": {
            "title": "IncallDestinationHangupNormal",
            "allOf": [
                {
                    "$ref": "#/definitions/IncallDestinationHangup"
                },
                {
                    "properties": {
                        "cause": {
                            "type": "string",
                            "description": "MUST be 'normal'"
                        }
                    }
                }
            ],
            "required": [
                "cause"
            ]
        },
        "IncallDestinationNone": {
            "title": "IncallDestinationNone",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'none'"
                }
            },
            "required": [
                "type"
            ]
        },
        "IncallDestinationOutcall": {
            "title": "IncallDestinationOutcall",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'outcall'"
                },
                "exten": {
                    "type": "string"
                },
                "outcall_id": {
                    "type": "integer",
                    "description": "The id of the outcall"
                }
            },
            "required": [
                "type",
                "exten",
                "outcall_id"
            ]
        },
        "IncallDestinationSound": {
            "title": "IncallDestinationSound",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'sound'"
                },
                "filename": {
                    "type": "string",
                    "description": "The filename of the sound. The file MUST be imported by to webi in the playback directory. The extension of file SHOULD be not present."
                },
                "skip": {
                    "type": "boolean",
                    "description": "Do not play this sound if the call is not answered"
                },
                "no_answer": {
                    "type": "boolean",
                    "description": "Play this sound without answering the call"
                }
            },
            "required": [
                "type",
                "exten",
                "outcall_id"
            ]
        },
        "IncallDestinationUser": {
            "title": "IncallDestinationUser",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'user'"
                },
                "user_id": {
                    "type": "integer",
                    "description": "The id of the user"
                },
                "ring_time": {
                    "type": "number",
                    "format": "float"
                }
            },
            "required": [
                "type",
                "user_id"
            ]
        },
        "IncallDestinationVoicemail": {
            "title": "IncallDestinationVoicemail",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "MUST be 'voicemail'"
                },
                "voicemail_id": {
                    "type": "integer",
                    "description": "The id of the voicemail"
                },
                "skip_instructions": {
                    "type": "boolean",
                    "description": "Skip the playback of instructions for leaving a message"
                },
                "greeting": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "enum": [
                        "busy",
                        "unavailable"
                    ],
                    "description": "Play the specified greeting"
                }
            },
            "required": [
                "type",
                "user_id"
            ]
        },
        "IncallItems": {
            "title": "IncallItems",
            "properties": {
                "items": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Incall"
                    }
                },
                "total": {
                    "type": "integer"
                }
            },
            "required": [
                "total"
            ]
        }
    }
}
