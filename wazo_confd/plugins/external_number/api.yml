paths:
  /external/numbers:
    get:
      operationId: list_external_numbers
      summary: List external numbers
      description: '**Required ACL:** `confd.external.numbers.read`'
      tags:
      - numbers
      parameters:
      - $ref: '#/parameters/tenantuuid'
      - $ref: '#/parameters/recurse'
      - $ref: '#/parameters/order'
      - $ref: '#/parameters/direction'
      - $ref: '#/parameters/limit'
      - $ref: '#/parameters/offset'
      - $ref: '#/parameters/search'
      - $ref: '#/parameters/shareable'
      - $ref: '#/parameters/main'
      responses:
        '200':
          description: External phone number list
          schema:
            $ref: '#/definitions/ExternalNumberItems'
    post:   
      operationId: create_external_number
      summary: Add a new extenral number
      description: '**Required ACL:** `confd.extenral.numbers.create`'
      tags:
      - numbers
      responses:
        '201':
          description: External number created
          schema:
            $ref: '#/definitions/ExternalNumber'
        '400':
          $ref: '#/responses/CreateError'
  /external/numbers/{number_uuid}:
    get:
      operationId: get_external_number
      summary: Get external number
      description: '**Required ACL:** `confd.external.numbers.{number_uuid}.read`'
      tags:
      - numbers
      parameters:
      - $ref: '#/parameters/tenantuuid'
      - $ref: '#/parameters/number_uuid'
      responses:
        '200':
          description: External Number
          schema:
            $ref: '#/definitions/ExternalNumber'
        '404':
          $ref: '#/responses/NotFoundError'
    put:
      operationId: update_external_numbers
      summary: Update External Number
      description: '**Required ACL:** `confd.external.numbers.{number_uuid}.update`'
      tags:
      - numbers
      parameters:
      - $ref: '#/parameters/tenantuuid'
      - $ref: '#/parameters/number_uuid'
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/ExternalNumberItems'
      responses:
        '204':
          $ref: '#/responses/ResourceUpdated'
        '400':
          $ref: '#/responses/UpdateError'
        '404':
          $ref: '#/responses/NotFoundError'
    delete:
      operationId: delete_external_number
      summary: Delete External Number
      description: '**Required ACL:** `confd.external.numbers.{number_uuid}.delete`'
      tags:
      - numbers
      parameters:
      - $ref: '#/parameters/tenantuuid'
      - $ref: '#/parameters/number_uuid'
      responses:
        '204':
          $ref: '#/responses/ResourceDeleted'
        '404':
          $ref: '#/responses/NotFoundError'

parameters:
  number_uuid:
    name: number_uuid
    in: path
    type: string
    description: UUID of the number
    required: true
  shareable:
    in: query
    name: shareable
    type: boolean
    description: Only include shareable numbers
  main:
    in: query
    name: main
    type: boolean
    description: Only include the main number
definitions:
  ExternalNumber:
    type: object
    description: a phone number resource, usable for outgoing caller id or incall routing
    properties:
      uuid:
        type: string
        description: Number UUID
        readOnly: true
      number: 
        type: string
        description: The e.164 representation of a phone number if possible
      caller_id_name:
        type: string
        description: The Caller ID name that should be used when calling with this number as a Caller ID
      tenant_uuid:
        type: string
        description: uuid of tenant
        readOnly: true
      shareable:
        type: boolean
        description: If this number is meant to be shared by multiple people
      main:
        type: boolean
        description: If this is the main phone number for this tenant. Only one number can be the default number for a given tenant.
        default: false
    required:
      - number
      - shareable
  ExternalNumberItems:
    type: object
    properties:
      items:
        type: array
        items:
          $ref: '#/definitions/ExternalNumber'
